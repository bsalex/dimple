!function(e,i){"use strict";if("object"==typeof exports)module.exports=i(require("d3"));else if("function"==typeof define&&define.amd)define(["d3"],function(t){return e.dimple=i(t),e.dimple});else if(e.d3)e.dimple=i(e.d3);else{if(!console||!console.warn)throw"dimple requires d3 to run.  Are you missing a reference to the d3 library?";console.warn("dimple requires d3 to run.  Are you missing a reference to the d3 library?")}}(this,function(W){"use strict";var H={version:"2.2.0",plot:{},aggregateMethod:{},axis:function(t,e,i,s,a,r){this.chart=t,this.position=e,this.categoryFields=null==a?i:[].concat(a),this.measure=s,this.timeField=a,this.floatingBarWidth=5,this.hidden=!1,this.showPercent=!1,this.colors=null,this.overrideMin=null,this.overrideMax=null,this.shapes=null,this.showGridlines=null,this.gridlineShapes=null,this.titleShape=null,this.dateParseFormat=null,this.tickFormat=null,this.timePeriod=null,this.timeInterval=1,this.useLog=!1,this.logBase=10,this.title=void 0,this.clamp=!0,this.ticks=null,this.fontSize="10px",this.fontFamily="sans-serif",this.autoRotateLabel=null==r||r,this._slaves=[],this._scale=null,this._min=0,this._max=0,this._previousOrigin=null,this._origin=null,this._orderRules=[],this._groupOrderRules=[],this._draw=null,this._getAxisData=function(){var t,e,i=[],s=!1;if(this.chart&&this.chart.series){for(t=0;t<this.chart.series.length;t+=1)(e=this.chart.series[t])[this.position]===this&&(e.data&&0<e.data.length?i=i.concat(e.data):s=!0);s&&this.chart.data&&(i=i.concat(this.chart.data))}return i},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(10<this.chart._heightPixels()/35?this.chart._heightPixels()/35:10)+"px"},this._getFormat=function(){var t,e,i,s,a,r,n;return null!==this.tickFormat&&void 0!==this.tickFormat?t=this._hasTimeField()?W.timeFormat(this.tickFormat):W.format(this.tickFormat):this.showPercent?t=W.format("."+Math.max(0,W.precisionFixed(this._tick_step)-2)+"%"):this.useLog&&null!==this.measure?t=function(t){var e=Math.floor(Math.abs(t),0).toString().length,i=Math.min(Math.floor((e-1)/3),4),s="kmBT".substring(i-1,i),a="0"===Math.round(t/Math.pow(1e3,i)*10).toString().slice(-1)?0:1;return 0===t?0:W.format(",."+a+"f")(t/Math.pow(1e3,i))+s}:null!==this.measure?(e=Math.floor(Math.abs(this._max),0).toString(),i=Math.floor(Math.abs(this._min),0).toString(),3<(s=Math.max(i.length,e.length))?(a=Math.min(Math.floor((s-1)/3),4),r="kmBT".substring(a-1,a),n=s-3*a<=1?1:0,t=function(t){return 0===t?0:W.format(",."+n+"f")(t/Math.pow(1e3,a))+r}):(n=Math.max(0,-Math.floor(Math.log(this._tick_step)/Math.LN10)),t=W.format(",."+(Number.isFinite(n)?n:0)+"f"))):t=function(t){return t},t},this._getTimePeriod=function(){var t=this.timePeriod,e=30,i=this._max-this._min;return this._hasTimeField()&&!this.timePeriod&&(t=i/1e3<=e?W.timeSecond:i/6e4<=e?W.timeMinute:i/36e5<=e?W.timeHour:i/864e5<=e?W.timeDay:i/6048e5<=e?W.timeWeek:i/26298e5<=e?W.timeMonth:W.timeYear),t},this._getTooltipText=function(i,s){if(this._hasTimeField())s[this.position+"Field"][0]&&i.push(this.timeField+": "+this._getFormat()(s[this.position+"Field"][0]));else if(this._hasCategories())this.categoryFields.forEach(function(t,e){null!=t&&s[this.position+"Field"][e]&&i.push(t+(s[this.position+"Field"][e]!==t?": "+s[this.position+"Field"][e]:""))},this);else if(this._hasMeasure())switch(this.position){case"x":i.push(this.measure+": "+this._getFormat()(s.width));break;case"y":i.push(this.measure+": "+this._getFormat()(s.height));break;case"p":i.push(this.measure+": "+this._getFormat()(s.angle)+" ("+W.format(".0%")(s.piePct)+")");break;default:i.push(this.measure+": "+this._getFormat()(s[this.position+"Value"]))}},this._getTopMaster=function(){var t=this;return null!==this.master&&void 0!==this.master&&(t=this.master._getTopMaster()),t},this._hasCategories=function(){return null!==this.categoryFields&&void 0!==this.categoryFields&&0<this.categoryFields.length},this._hasMeasure=function(){return null!==this.measure&&void 0!==this.measure},this._hasTimeField=function(){return null!==this.timeField&&void 0!==this.timeField},this._parseDate=function(t){return null===this.dateParseFormat||void 0===this.dateParseFormat?isNaN(t)?Date.parse(t):new Date(t):W.timeParse(this.dateParseFormat)(t)},this._update=function(t){var e,i,s,a,r=[],n=this.ticks||10,o=function(e,i,s){var t,a,r=e.categoryFields[0],n=e._getAxisData(),o=r,l=!1,h=!0,u=null;for(t=0;t<n.length;t+=1)if(null!=(u=e._parseDate(n[t][r]))&&isNaN(u)){h=!1;break}return h||e.chart.series.forEach(function(t){t[i]===e&&t[s]._hasMeasure()&&(o=t[s].measure,l=!0)},this),a=e._orderRules.concat({ordering:o,desc:l}),H._getOrderedList(n,r,a)};if(this._min=this.showPercent&&this._min<-1?-1:this._min,this._max=this.showPercent&&1<this._max?1:this._max,this._min=null!==this.overrideMin?this.overrideMin:this._min,this._max=null!==this.overrideMax?this.overrideMax:this._max,"x"!==this.position||null!==this._scale&&!t){if("y"!==this.position||null!==this._scale&&!t)0<this.position.length&&"z"===this.position[0]&&null===this._scale?this.useLog?this._scale=W.scaleLog().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=W.scaleLinear().range([1,this.chart._heightPixels()/10]).domain([this._min,this._max]).clamp(this.clamp):0<this.position.length&&"p"===this.position[0]&&null===this._scale?this.useLog?this._scale=W.scaleLog().range([0,360]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=W.scaleLinear().range([0,360]).domain([this._min,this._max]).clamp(this.clamp):0<this.position.length&&"c"===this.position[0]&&null===this._scale&&(this._scale=W.scaleLinear().range([0,null===this.colors||1===this.colors.length?1:this.colors.length-1]).domain([this._min,this._max]).clamp(this.clamp));else if(this._hasTimeField()?this._scale=W.scaleTime().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=W.scaleLog().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(r=o(this,"y","x"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach(function(t){r=r.concat(o(t,"y","x"))},this),this._scale=W.scalePoint().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain(r.concat([""]))):this._scale=W.scaleLinear().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"y")){case 0:this._draw=W.axisLeft().scale(this._scale),this.ticks&&this._draw.ticks(n);break;case 1:this._draw=W.axisRight().scale(this._scale),this.ticks&&this._draw.ticks(n)}}else if(this._hasTimeField()?this._scale=W.scaleTime().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=W.scaleLog().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(r=o(this,"x","y"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach(function(t){r=r.concat(o(t,"x","y"))},this),this._scale=W.scalePoint().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain(r.concat([""]))):this._scale=W.scaleLinear().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"x")){case 0:this._draw=W.axisBottom().scale(this._scale),this.ticks&&this._draw.ticks(n);break;case 1:this._draw=W.axisTop().scale(this._scale),this.ticks&&this._draw.ticks(n)}return null!==this._slaves&&void 0!==this._slaves&&0<this._slaves.length&&this._slaves.forEach(function(t){t._scale=this._scale},this),null!=t&&!1!==t||this._hasTimeField()||null===this._scale||null===this._scale.ticks||void 0===this._scale.ticks||!(0<this._scale.ticks(n).length)||"x"!==this.position&&"y"!==this.position||(i=(e=this._scale.ticks(n))[1]-e[0],s=((this._max-this._min)%i).toFixed(0),this._tick_step=i,0!==s&&(this._max=Math.ceil(this._max/i)*i,this._min=Math.floor(this._min/i)*i,this._update(!0))),a=null!=r&&0<r.length?this._scale.copy()(r[0]):0<this._min?this._scale.copy()(this._min):this._max<0?this._scale.copy()(this._max):this._scale.copy()(0),this._origin!==a&&(this._previousOrigin=null===this._origin?a:this._origin,this._origin=a),this},this.addGroupOrderRule=function(t,e){this._groupOrderRules.push({ordering:t,desc:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})}},chart:function(t,e){this.svg=t,this.x="10%",this.y="10%",this.width="80%",this.height="80%",this.data=e,this.noFormats=!1,this.axes=[],this.series=[],this.legends=[],this.storyboard=null,this.titleShape=null,this.shapes=null,this.ease=W.easeCubicInOut,this.staggerDraw=!1,this.transition={},this._group=t.append("g"),this._group.attr("class","dimple-chart"),this._gridlines_group=this._group.insert("g"),this._gridlines_group.attr("class","dimple-gridlines-group"),this._axis_group=this._group.insert("g"),this._axis_group.attr("class","dimple-axis-group"),this._tooltipGroup=null,this._assignedColors={},this._assignedClasses={},this._nextColor=0,this._nextClass=0,this._axisIndex=function(t,e){var i=0,s=0,a=-1;for(i=0;i<this.axes.length;i+=1){if(this.axes[i]===t){a=s;break}null!=e&&e[0]!==this.axes[i].position[0]||(s+=1)}return a},this._getAllData=function(){var e=[];return null!==this.data&&void 0!==this.data&&0<this.data.length&&(e=e.concat(this.data)),null!==this.series&&void 0!==this.series&&0<this.series.length&&this.series.forEach(function(t){null!==t.data&&void 0!==t.data&&0<t.data.length&&(e=e.concat(t.data))}),e},this._getData=function(t,d,p,e,h,g,_,f,x,y){var i,s,m=[],v=function(t,e){var i=[];return null!==t&&(t._hasTimeField()?i.push(t._parseDate(e[t.timeField])):t._hasCategories()&&t.categoryFields.forEach(function(t){i.push(e[t])},this)),i},F={x:!1,y:!1,z:!1,p:!1,c:!1},u={x:[],y:[]},c={x:[],y:[],z:[],p:[]},r={min:null,max:null},k={x:[],y:[],z:[],p:[]},w=[],C={},b={x:0,y:0,z:0,p:0},P="",B=[],S=[],M=[],L="",T=[],z="",O=[],A="",V=[],a=[],n=t,o=[];for(s in this.storyboard&&0<this.storyboard.categoryFields.length&&(P=this.storyboard.categoryFields[0],B=H._getOrderedList(n,P,this.storyboard._orderRules)),g&&g._hasCategories()&&g._hasMeasure()&&(L=g.categoryFields[0],T=H._getOrderedList(n,L,g._orderRules.concat([{ordering:g.measure,desc:!0}]))),_&&_._hasCategories()&&_._hasMeasure()&&(z=_.categoryFields[0],O=H._getOrderedList(n,z,_._orderRules.concat([{ordering:_.measure,desc:!0}]))),x&&x._hasCategories()&&x._hasMeasure()&&(A=x.categoryFields[0],V=H._getOrderedList(n,A,x._orderRules.concat([{ordering:x.measure,desc:!0}]))),0<n.length&&d&&0<d.length&&(a=[].concat(e),S=[],d.forEach(function(t){void 0!==n[0][t]&&S.push(t)},this),x&&x._hasMeasure()?a.push({ordering:x.measure,desc:!0}):y&&y._hasMeasure()?a.push({ordering:y.measure,desc:!0}):f&&f._hasMeasure()?a.push({ordering:f.measure,desc:!0}):g&&g._hasMeasure()?a.push({ordering:g.measure,desc:!0}):_&&_._hasMeasure()&&a.push({ordering:_.measure,desc:!0}),M=H._getOrderedList(n,S,a)),n.sort(function(t,e){var i,s,a,r,n,o,l=0;if(""!==P&&(l=B.indexOf(t[P])-B.indexOf(e[P])),""!==L&&0===l&&(l=T.indexOf(t[L])-T.indexOf(e[L])),""!==z&&0===l&&(l=O.indexOf(t[z])-O.indexOf(e[z])),""!==A&&0===l&&(l=V.indexOf(t[A])-O.indexOf(e[A])),S&&0<S.length&&0===l)for(i=[].concat(S),a=l=0;a<M.length;a+=1){for(s=[].concat(M[a]),o=n=!0,r=0;r<i.length;r+=1)n=n&&t[i[r]]===s[r],o=o&&e[i[r]]===s[r];if(n||o){l=n&&o?0:n?-1:1;break}}return l}),n.forEach(function(l){var t,e,i,s,a,h=-1,r=v(g,l),n=v(_,l),o=v(f,l),u=v(x,l),c=[];if(d&&0!==d.length)for(i=0;i<d.length;i+=1)void 0===l[d[i]]?c.push(d[i]):c.push(l[d[i]]);else c=["All"];for(t=c.join("/")+"_"+r.join("/")+"_"+n.join("/")+"_"+u.join("/")+"_"+o.join("/"),e=0;e<m.length;e+=1)if(m[e].key===t){h=e;break}-1===h&&(s={key:t,aggField:c,xField:r,xValue:null,xCount:0,yField:n,yValue:null,yCount:0,pField:u,pValue:null,pCount:0,zField:o,zValue:null,zCount:0,cValue:0,cCount:0,x:0,y:0,xOffset:0,yOffset:0,width:0,height:0,cx:0,cy:0,xBound:0,yBound:0,xValueList:[],yValueList:[],zValueList:[],pValueList:[],cValueList:[],fill:{},stroke:{}},m.push(s),h=m.length-1),(a=function(t,e){var i,s,a=!0,r={value:0,count:1},n={value:0,count:1},o="";null!==e&&(i=e.getFrameValue(),e.categoryFields.forEach(function(t,e){0<e&&(o+="/"),o+=l[t],a=o===i},this)),null!=t&&a&&(s=m[h],t._hasMeasure()&&null!==l[t.measure]&&void 0!==l[t.measure]&&(-1===s[t.position+"ValueList"].indexOf(l[t.measure])&&s[t.position+"ValueList"].push(l[t.measure]),isNaN(parseFloat(l[t.measure]))&&(F[t.position]=!0),r.value=s[t.position+"Value"],r.count=s[t.position+"Count"],n.value=l[t.measure],s[t.position+"Value"]=p(r,n),s[t.position+"Count"]+=1))})(g,this.storyboard),a(_,this.storyboard),a(f,this.storyboard),a(x,this.storyboard),a(y,this.storyboard)},this),g&&g._hasCategories()&&1<g.categoryFields.length&&void 0!==u.x&&(o=[],_._hasMeasure()&&o.push({ordering:_.measure,desc:!0}),u.x=H._getOrderedList(n,g.categoryFields[1],g._groupOrderRules.concat(o))),_&&_._hasCategories()&&1<_.categoryFields.length&&void 0!==u.y&&(o=[],g._hasMeasure()&&o.push({ordering:g.measure,desc:!0}),u.y=H._getOrderedList(n,_.categoryFields[1],_._groupOrderRules.concat(o)),u.y.reverse()),m.forEach(function(t){null!==g&&(!0===F.x&&(t.xValue=t.xValueList.length),i=g._hasMeasure()&&g._hasCategories()?(c.x[t.xField.join("/")]||0)+(g._hasMeasure()?Math.abs(t.xValue):0):(c.x[t.xField.join("/")]||0)+(_._hasMeasure()?Math.abs(t.yValue):0),c.x[t.xField.join("/")]=i),null!==_&&(!0===F.y&&(t.yValue=t.yValueList.length),i=_._hasMeasure()&&_._hasCategories()?(c.y[t.yField.join("/")]||0)+(_._hasMeasure()?Math.abs(t.yValue):0):(c.y[t.yField.join("/")]||0)+(g._hasMeasure()?Math.abs(t.xValue):0),c.y[t.yField.join("/")]=i),null!==x&&(!0===F.p&&(t.pValue=t.pValueList.length),i=(c.p[t.pField.join("/")]||0)+(x._hasMeasure()?Math.abs(t.pValue):0),c.p[t.pField.join("/")]=i),null!==f&&(!0===F.z&&(t.zValue=t.zValueList.length),i=(c.z[t.zField.join("/")]||0)+(f._hasMeasure()?Math.abs(t.zValue):0),c.z[t.zField.join("/")]=i),null!==y&&((null===r.min||t.cValue<r.min)&&(r.min=t.cValue),(null===r.max||t.cValue>r.max)&&(r.max=t.cValue))},this),c.x)c.x.hasOwnProperty(s)&&(b.x+=c.x[s]);for(s in c.y)c.y.hasOwnProperty(s)&&(b.y+=c.y[s]);for(s in c.p)c.p.hasOwnProperty(s)&&(b.p+=c.p[s]);for(s in c.z)c.z.hasOwnProperty(s)&&(b.z+=c.z[s]);return m.forEach(function(l){var t,e,i,s,a=function(t,e,i){var s,a,r,n,o;null!=t&&(n=t.position,t._hasCategories()?t._hasMeasure()?(s=l[t.position+"Field"].join("/"),a=t.showPercent?c[t.position][s]/b[t.position]:c[t.position][s],-1===w.indexOf(s)&&(C[s]=a+(0<w.length?C[w[w.length-1]]:0),w.push(s)),r=l[n+"Bound"]=l["c"+n]="x"!==n&&"y"!==n||!h?a:C[s],l[i]=a,l[n]=r-("x"===n&&0<=a||"y"===n&&a<=0?a:0)):(l[n]=l["c"+n]=l[n+"Field"][0],l[i]=1,void 0!==u[n]&&null!==u[n]&&2<=u[n].length&&(l[n+"Offset"]=u[n].indexOf(l[n+"Field"][1]),l[i]=1/u[n].length)):(a=t.showPercent?l[n+"Value"]/c[e][l[e+"Field"].join("/")]:l[n+"Value"],s=l[e+"Field"].join("/")+(0<=l[n+"Value"]),o=k[n][s]=(null===k[n][s]||void 0===k[n][s]||"z"===n||"p"===n?0:k[n][s])+a,r=l[n+"Bound"]=l["c"+n]="x"!==n&&"y"!==n||!h?a:o,l[i]=a,l[n]=r-("x"===n&&0<=a||"y"===n&&a<=0?a:0)))};a(g,"y","width"),a(_,"x","height"),a(f,"z","r"),a(x,"p","angle"),null!==y&&null!==r.min&&null!==r.max&&(r.min===r.max&&(r.min-=.5,r.max+=.5),r.min=y.overrideMin||r.min,r.max=y.overrideMax||r.max,l.cValue=l.cValue>r.max?r.max:l.cValue<r.min?r.min:l.cValue,s=(i=W.scaleLinear().range([0,null===y.colors||1===y.colors.length?1:y.colors.length-1]).domain([r.min,r.max])(l.cValue))-Math.floor(i),l.cValue===r.max&&(s=1),y.colors&&1===y.colors.length?(t=W.rgb(y.colors[0]),e=W.rgb(this.getColor(l.aggField.slice(-1)[0]).fill)):y.colors&&1<y.colors.length?(t=W.rgb(y.colors[Math.floor(i)]),e=W.rgb(y.colors[Math.ceil(i)])):(t=W.rgb("white"),e=W.rgb(this.getColor(l.aggField.slice(-1)[0]).fill)),t.r=Math.floor(t.r+(e.r-t.r)*s),t.g=Math.floor(t.g+(e.g-t.g)*s),t.b=Math.floor(t.b+(e.b-t.b)*s),l.fill=t.toString(),l.stroke=t.darker(.5).toString())},this),m},this._getDelay=function(i,s,a){return function(t){var e=0;return a&&s.staggerDraw&&(a.x._hasCategories()?e=H._helpers.cx(t,s,a)/s._widthPixels()*i:a.y._hasCategories()&&(e=(1-H._helpers.cy(t,s,a)/s._heightPixels())*i)),e}},this._getSeriesData=function(){null!==this.series&&void 0!==this.series&&this.series.forEach(function(t){var e,i,s,a,r,n=t.data||this.data||[],o=[].concat(t.categoryFields||"All"),l=this._getData(n,o,t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),h=[],u={},c=t.startAngle*(Math.PI/180)||0,d=(t.endAngle||360)*(Math.PI/180);if(d<c&&(c-=2*Math.PI),t.p&&0<o.length){if(t.x&&t.y){for(o.pop(),h=this._getData(n,["__dimple_placeholder__"].concat(o),t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),e=0;e<l.length;e+=1)for((s=["__dimple_placeholder__"].concat(l[e].aggField)).pop(),t.x&&t.x._hasCategories()&&(s=s.concat(l[e].xField)),t.y&&t.y._hasCategories()&&(s=s.concat(l[e].yField)),a=s.join("|"),i=0;i<h.length;i+=1)if(r=[].concat(h[i].aggField),t.x&&t.x._hasCategories()&&(r=r.concat(h[i].xField)),t.y&&t.y._hasCategories()&&(r=r.concat(h[i].yField)),a===r.join("|")){l[e].xField=h[i].xField,l[e].xValue=h[i].xValue,l[e].xCount=h[i].xCount,l[e].yField=h[i].yField,l[e].yValue=h[i].yValue,l[e].yCount=h[i].yCount,l[e].zField=h[i].zField,l[e].zValue=h[i].zValue,l[e].zCount=h[i].zCount,l[e].x=h[i].x,l[e].y=h[i].y,l[e].r=h[i].r,l[e].xOffset=h[i].xOffset,l[e].yOffset=h[i].yOffset,l[e].width=h[i].width,l[e].height=h[i].height,l[e].cx=h[i].cx,l[e].cy=h[i].cy,l[e].xBound=h[i].xBound,l[e].yBound=h[i].yBound,l[e].xValueList=h[i].xValueList,l[e].yValueList=h[i].yValueList,l[e].zValueList=h[i].zValueList,l[e].cValueList=h[i].cValueList,l[e].pieKey=h[i].key,l[e].value=l.pValue,u[h[i].key]||(u[h[i].key]={total:0,angle:c}),u[h[i].key].total+=l[e].pValue;break}}else for(e=0;e<l.length;e+=1)l[e].pieKey="All",l[e].value=l.pValue,u[l[e].pieKey]||(u[l[e].pieKey]={total:0,angle:c}),u[l[e].pieKey].total+=l[e].pValue;for(e=0;e<l.length;e+=1)0===u[l[e].pieKey].total?l[e].piePct=0:l[e].piePct=l[e].pValue/u[l[e].pieKey].total,l[e].startAngle=u[l[e].pieKey].angle,l[e].endAngle=l[e].startAngle+l[e].piePct*(d-c),u[l[e].pieKey].angle=l[e].endAngle}t._positionData=l},this)},this._handleTransition=function(t,e,i,s){var a=null;return 0===e?a=t:(a=t.transition().duration(e).delay(i._getDelay(e,i,s)),H._ease(a,i.ease)),a},this._heightPixels=function(){return H._parseYPosition(this.height,this.svg.node())},this._registerEventHandlers=function(s){null!==s._eventHandlers&&0<s._eventHandlers.length&&s._eventHandlers.forEach(function(i){var t,e=function(t){var e=new H.eventArgs;null!==s.chart.storyboard&&(e.frameValue=s.chart.storyboard.getFrameValue()),e.seriesValue=t.aggField,e.xValue=t.x,e.yValue=t.y,e.zValue=t.z,e.pValue=t.p,e.colorValue=t.cValue,e.seriesShapes=s.shapes,e.selectedShape=W.select(this),i.handler(e)};if(null!==i.handler&&"function"==typeof i.handler)if(null!==s._markers&&void 0!==s._markers)for(t in s._markers)s._markers.hasOwnProperty(t)&&s._markers[t].on(i.event,e);else s.shapes.on(i.event,e)},this)},this._widthPixels=function(){return H._parseXPosition(this.width,this.svg.node())},this._xPixels=function(){return H._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return H._parseYPosition(this.y,this.svg.node())},this.addAxis=function(t,e,i,s){var a,r=null,n=null;if(null!=e&&(e=[].concat(e)),"string"==typeof t||t instanceof String)r=new H.axis(this,t,e,i,s),this.axes.push(r);else{if(n=t,(r=new H.axis(this,n.position,e,i,s))._hasMeasure()!==n._hasMeasure()?a="You have specified a composite axis where some but not all axes have a measure - this is not supported, all axes must be of the same type.":r._hasTimeField()!==n._hasTimeField()?a="You have specified a composite axis where some but not all axes have a time field - this is not supported, all axes must be of the same type.":(null===r.categoryFields||void 0===r.categoryFields?0:r.categoryFields.length)!==(null===n.categoryFields||void 0===n.categoryFields?0:n.categoryFields.length)&&(a="You have specified a composite axis where axes have differing numbers of category fields - this is not supported, all axes must be of the same type."),a)throw a;n._slaves.push(r)}return r},this.addCategoryAxis=function(t,e){return this.addAxis(t,e,null)},this.addColorAxis=function(t,e){var i=this.addAxis("c",null,t);return i.colors=null==e?null:[].concat(e),i},this.addLegend=function(t,e,i,s,a,r){r=null==r?this.series:[].concat(r),a=null==a?"left":a;var n=new H.legend(this,t,e,i,s,a,r);return this.legends.push(n),n},this.addLogAxis=function(t,e,i){var s=this.addAxis(t,null,e,null);return null!=i&&(s.logBase=i),s.useLog=!0,s},this.addMeasureAxis=function(t,e){return this.addAxis(t,null,e)},this.addPctAxis=function(t,e,i){var s=null;return(s=null!=i?this.addAxis(t,i,e):this.addMeasureAxis(t,e)).showPercent=!0,s},this.addSeries=function(t,e,i){null==i&&(i=this.axes),null==e&&(e=H.plot.bubble);var s,a=null,r=null,n=null,o=null,l=null;return i.forEach(function(t){null!==t&&-1<e.supportedAxes.indexOf(t.position)&&(null===a&&"x"===t.position[0]?a=t:null===r&&"y"===t.position[0]?r=t:null===n&&"z"===t.position[0]?n=t:null===o&&"c"===t.position[0]?o=t:null===o&&"p"===t.position[0]&&(l=t))},this),t&&(t=[].concat(t)),s=new H.series(this,t,a,r,n,o,l,e,H.aggregateMethod.sum,e.stacked),this.series.push(s),s},this.addTimeAxis=function(t,e,i,s){var a=this.addAxis(t,null,null,e);return a.tickFormat=s,a.dateParseFormat=i,a},this.assignClass=function(t,e){return this._assignedClasses[t]=e,this._assignedClasses[t]},this.assignColor=function(t,e,i,s){return this._assignedColors[t]=new H.color(e,i,s),this._assignedColors[t]},this.customClassList={axisLine:"dimple-custom-axis-line",axisLabel:"dimple-custom-axis-label",axisTitle:"dimple-custom-axis-title",tooltipBox:"dimple-custom-tooltip-box",tooltipLabel:"dimple-custom-tooltip-label",tooltipDropLine:"dimple-custom-tooltip-dropline",lineMarker:"dimple-custom-line-marker",lineMarkerCircle:"dimple-custom-line-marker-circle",legendLabel:"dimple-custom-legend-label",legendKey:"dimple-custom-legend-key",areaSeries:"dimple-custom-series-area",barSeries:"dimple-custom-series-bar",bubbleSeries:"dimple-custom-series-bubble",lineSeries:"dimple-custom-series-line",pieSeries:"dimple-custom-series-pie",gridline:"dimple-custom-gridline",colorClasses:["dimple-custom-format-1","dimple-custom-format-2","dimple-custom-format-3","dimple-custom-format-4","dimple-custom-format-5","dimple-custom-format-6","dimple-custom-format-7","dimple-custom-format-8","dimple-custom-format-9","dimple-custom-format-10"]},this.defaultColors=[new H.color("#80B1D3"),new H.color("#FB8072"),new H.color("#FDB462"),new H.color("#B3DE69"),new H.color("#FFED6F"),new H.color("#BC80BD"),new H.color("#8DD3C7"),new H.color("#CCEBC5"),new H.color("#FFFFB3"),new H.color("#BEBADA"),new H.color("#FCCDE5"),new H.color("#D9D9D9")],this.draw=function(_,t){_=_||0;var a,r,f=null,x=null,y=!1,m=!1,v=this._xPixels(),F=this._yPixels(),k=this._widthPixels(),w=this._heightPixels();return null!=t&&!1!==t||this._getSeriesData(),this.axes.forEach(function(t){t._scale=null},this),this.axes.forEach(function(s){if(s._min=0,s._max=0,r=[],s._hasMeasure()){var i=!1;this.series.forEach(function(t){if(t._deepMatch(s)){var e=t._axisBounds(s.position);s._min>e.min&&(s._min=e.min),s._max<e.max&&(s._max=e.max),i=!0}},this),i||this._getAllData().forEach(function(t){s._min>t[s.measure]&&(s._min=t[s.measure]),s._max<t[s.measure]&&(s._max=t[s.measure])},this)}else s._hasTimeField()?(s._min=null,s._max=null,this.series.forEach(function(t){t._deepMatch(s)&&null!==t[s.position].timeField&&void 0!==t[s.position].timeField&&-1===r.indexOf(t[s.position].timeField)&&r.push(t[s.position].timeField)},this),s._getAxisData().forEach(function(i){r.forEach(function(t){var e=s._parseDate(i[t]);(null===s._min||e<s._min)&&(s._min=e),(null===s._max||e>s._max)&&(s._max=e)},this)},this)):s._hasCategories()&&(s._min=0,a=[],this.series.forEach(function(t){t._deepMatch(s)&&null!==t[s.position].categoryFields[0]&&void 0!==t[s.position].categoryFields[0]&&-1===r.indexOf(t[s.position].categoryFields[0])&&r.push(t[s.position].categoryFields[0])},this),s._getAxisData().forEach(function(e){r.forEach(function(t){-1===a.indexOf(e[t])&&a.push(e[t])},this)},this),s._max=a.length);null!==s._slaves&&void 0!==s._slaves&&0<s._slaves.length&&s._slaves.forEach(function(t){t._min=s._min,t._max=s._max},this),s._update(),null===f&&"x"===s.position?f=s:null===x&&"y"===s.position&&(x=s)},this),this.axes.forEach(function(e){var i=!1,s=null,t=0,a=null,r=!1,n=0,o={l:null,t:null,r:null,b:null},l=0,h=0,u="",c=this,d=function(t){return null===s||0===_||i?t:c._handleTransition(t,_,c)},p=function(){var t=W.select(this).selectAll("text");return!e.measure&&0<e._max&&("x"===e.position?t.attr("x",k/e._max/2):"y"===e.position&&t.attr("y",w/e._max*-1/2)),e.categoryFields&&0<e.categoryFields.length&&(e!==f||null!==x.categoryFields&&0!==x.categoryFields.length||t.attr("y",F+w-x._scale(0)+9),e!==x||null!==f.categoryFields&&0!==f.categoryFields.length||t.attr("x",-1*(f._scale(0)-v)-9)),this},g=function(e){return function(){var t=W.select(this).attr("class")||"";return-1===t.indexOf(e)&&(t+=" "+e),t.trim()}};null===e.gridlineShapes?(e.showGridlines||null===e.showGridlines&&!e._hasCategories()&&(!y&&"x"===e.position||!m&&"y"===e.position))&&(e.gridlineShapes=this._gridlines_group.append("g").attr("class","dimple-gridline"),"x"===e.position?y=!0:m=!0):"x"===e.position?y=!0:m=!0,null===e.shapes&&(e.shapes=this._axis_group.append("g").attr("class","dimple-axis dimple-axis-"+e.position).each(function(){c.noFormats||W.select(this).style("font-family",e.fontFamily).style("font-size",e._getFontSize())}),i=!0),e===f&&null!==x?(s="translate(0, "+(null===x.categoryFields||0===x.categoryFields.length?x._scale(0):F+w)+")",a="translate(0, "+(e===f?F+w:F)+")",t=-w):e===x&&null!==f?(s="translate("+(null===f.categoryFields||0===f.categoryFields.length?f._scale(0):v)+", 0)",a="translate("+(e===x?v:v+k)+", 0)",t=-k):"x"===e.position?(a=s="translate(0, "+(e===f?F+w:F)+")",t=-w):"y"===e.position&&(a=s="translate("+(e===x?v:v+k)+", 0)",t=-k),null!==s&&null!==e._draw&&(e._hasTimeField()?d(e.shapes).call(e._draw.ticks(e._getTimePeriod(),e.timeInterval).tickFormat(e._getFormat())).attr("transform",s).each(p):e.useLog?d(e.shapes).call(e._draw.ticks(4,e._getFormat())).attr("transform",s).each(p):d(e.shapes).call(e._draw.tickFormat(e._getFormat())).attr("transform",s).each(p),null!==e.gridlineShapes&&d(e.gridlineShapes).call(e._draw.tickSize(t,0,0).tickFormat("")).attr("transform",a)),d(e.shapes.selectAll("text")).attr("class",g(c.customClassList.axisLabel)).call(function(t){c.noFormats||t.style("font-family",e.fontFamily).style("font-size",e._getFontSize())}),d(e.shapes.selectAll("path, line")).attr("class",g(c.customClassList.axisLine)).call(function(t){c.noFormats||t.style("fill","none").style("stroke","black").style("shape-rendering","crispEdges")}),null!==e.gridlineShapes&&(e.gridlineShapes.selectAll("path").remove(),d(e.gridlineShapes.selectAll("line")).attr("class",g(c.customClassList.gridline)).call(function(t){c.noFormats||t.style("fill","none").style("stroke","lightgray").style("opacity",.8)})),null!==e.measure&&void 0!==e.measure||(e.autoRotateLabel?e===f?(n=0,e.shapes.selectAll("text").each(function(){var t=this.getComputedTextLength();n=n<t?t:n}),n>k/e.shapes.selectAll("text").size()?(r=!0,e.shapes.selectAll("text").style("text-anchor","start").each(function(){var t=this.getBBox();W.select(this).attr("transform","rotate(90,"+t.x+","+(t.y+t.height/2)+") translate(-5, 0)")})):(r=!1,e.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):"x"===e.position&&(n=0,e.shapes.selectAll("text").each(function(){var t=this.getComputedTextLength();n=n<t?t:n}),n>k/e.shapes.selectAll("text").size()?(r=!0,e.shapes.selectAll("text").style("text-anchor","end").each(function(){var t=this.getBBox();W.select(this).attr("transform","rotate(90,"+(t.x+t.width)+","+(t.y+t.height/2)+") translate(5, 0)")})):(r=!1,e.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):(r=!1,e.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))),null!==e.titleShape&&void 0!==e.titleShape&&e.titleShape.remove(),e.shapes.selectAll("text").each(function(){var t=this.getBBox();(null===o.l||-9-t.width<o.l)&&(o.l=-9-t.width),(null===o.r||t.x+t.width>o.r)&&(o.r=t.x+t.width),r?((null===o.t||t.y+t.height-t.width<o.t)&&(o.t=t.y+t.height-t.width),(null===o.b||t.height+t.width>o.b)&&(o.b=t.height+t.width)):((null===o.t||t.y<o.t)&&(o.t=t.y),(null===o.b||9+t.height>o.b)&&(o.b=9+t.height))}),"x"===e.position?(h=e===f?F+w+o.b+5:F+o.t-10,l=v+k/2):"y"===e.position&&(u="rotate(270, "+(l=e===x?v+o.l-10:v+k+o.r+20)+", "+(h=F+w/2)+")"),e.hidden||"x"!==e.position&&"y"!==e.position||null===e.title||(e.titleShape=this._axis_group.append("text").attr("class","dimple-axis dimple-title "+c.customClassList.axisTitle+" dimple-axis-"+e.position),e.titleShape.attr("x",l).attr("y",h).attr("text-anchor","middle").attr("transform",u).text(void 0!==e.title?e.title:null===e.categoryFields||void 0===e.categoryFields||0===e.categoryFields.length?e.measure:e.categoryFields.join("/")).each(function(){c.noFormats||W.select(this).style("font-family",e.fontFamily).style("font-size",e._getFontSize())}),e===f?e.titleShape.each(function(){W.select(this).attr("y",h+this.getBBox().height/1.65)}):e===x&&e.titleShape.each(function(){W.select(this).attr("x",l+this.getBBox().height/1.65)}))},this),this.series.forEach(function(t){t.plot.draw(this,t,_),this._registerEventHandlers(t)},this),this.legends.forEach(function(t){t._draw()},this),this.storyboard&&(this.storyboard._drawText(),this.storyboard.autoplay&&this.storyboard.startAnimation()),this},this.getClass=function(t){return this._assignedClasses[t]||(this._assignedClasses[t]=this.customClassList.colorClasses[this._nextClass],this._nextClass=(this._nextClass+1)%this.customClassList.colorClasses.length),this._assignedClasses[t]},this.getColor=function(t){return null!==this._assignedColors[t]&&void 0!==this._assignedColors[t]||(this._assignedColors[t]=this.defaultColors[this._nextColor],this._nextColor=(this._nextColor+1)%this.defaultColors.length),this._assignedColors[t]},this.setBounds=function(t,e,i,s){return this.x=t,this.y=e,this.width=i,this.height=s,this._xPixels=function(){return H._parseXPosition(this.x,this.svg.node())},this.draw(0,!0),this._yPixels=function(){return H._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return H._parseXPosition(this.width,this.svg.node())},this._heightPixels=function(){return H._parseYPosition(this.height,this.svg.node())},this},this.setMargins=function(t,e,i,s){return this.x=t,this.y=e,this.width=0,this.height=0,this._xPixels=function(){return H._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return H._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return H._parentWidth(this.svg.node())-this._xPixels()-H._parseXPosition(i,this.svg.node())},this._heightPixels=function(){return H._parentHeight(this.svg.node())-this._yPixels()-H._parseYPosition(s,this.svg.node())},this},this.setStoryboard=function(t,e){return this.storyboard=new H.storyboard(this,t),null!=e&&(this.storyboard.onTick=e),this.storyboard}},color:function(t,e,i){this.fill=t,this.stroke=null==e?W.rgb(t).darker(.5).toString():e,this.opacity=null==i?.8:i},eventArgs:function(){this.seriesValue=null,this.xValue=null,this.yValue=null,this.zValue=null,this.pValue=null,this.colorValue=null,this.frameValue=null,this.seriesShapes=null,this.selectedShape=null},legend:function(t,e,i,s,a,r,n){this.chart=t,this.series=n,this.x=e,this.y=i,this.width=s,this.height=a,this.horizontalAlign=r,this.shapes=null,this.fontSize="10px",this.fontFamily="sans-serif",this._draw=function(){var t,e=this._getEntries(),i=0,s=0,a=0,r=0,n=this;this.shapes&&this.shapes.remove(),(t=this.chart._group.selectAll(".dimple-dont-select-any").data(e).enter().append("g").attr("class",function(t){return"dimple-legend "+H._createClass(t.aggField)}).attr("opacity",1)).append("text").attr("class",function(t){return"dimple-legend dimple-legend-text "+H._createClass(t.aggField)+" "+n.chart.customClassList.legendLabel}).text(function(t){return t.key}).call(function(t){n.chart.noFormats||t.style("font-family",n.fontFamily).style("font-size",n._getFontSize()).style("shape-rendering","crispEdges")}).each(function(){var t=this.getBBox();t.width>i&&(i=t.width),t.height>s&&(s=t.height)}),t.append("rect").attr("class",function(t){return"dimple-legend dimple-legend-key "+H._createClass(t.aggField)}).attr("height",9).attr("width",15),s=(s<9?9:s)+n._getVerticalPadding(),i+=15+n._getHorizontalPadding(),t.each(function(e){a+i>n._widthPixels()&&(a=0,r+=s),r>n._heightPixels()?W.select(this).remove():(W.select(this).select("text").attr("x","left"===n.horizontalAlign?n._xPixels()+15+5+a:n._xPixels()+(n._widthPixels()-a-i)+15+5).attr("y",function(){return n._yPixels()+r+this.getBBox().height/1.65}).attr("width",n._widthPixels()).attr("height",n._heightPixels()),W.select(this).select("rect").attr("class",function(t){return"dimple-legend dimple-legend-key "+H._createClass(t.aggField)+" "+n.chart.customClassList.legendKey+" "+t.css}).attr("x","left"===n.horizontalAlign?n._xPixels()+a:n._xPixels()+(n._widthPixels()-a-i)).attr("y",n._yPixels()+r).attr("height",9).attr("width",15).call(function(t){n.chart.noFormats||t.style("fill",e.fill).style("stroke",e.stroke).style("opacity",e.opacity).style("shape-rendering","crispEdges")}),a+=i)}),this.shapes=t},this._getEntries=function(){var r=[];return this.series&&this.series.forEach(function(a){a._positionData.forEach(function(t){var e,i=-1,s=a.plot.grouped&&!a.x._hasCategories()&&!a.y._hasCategories()&&t.aggField.length<2?"All":t.aggField.slice(-1)[0];for(e=0;e<r.length;e+=1)if(r[e].key===s){i=e;break}-1===i&&a.chart._assignedColors[s]&&(r.push({key:s,fill:a.chart._assignedColors[s].fill,stroke:a.chart._assignedColors[s].stroke,opacity:a.chart._assignedColors[s].opacity,css:a.chart._assignedClasses[s],series:a,aggField:t.aggField}),i=r.length-1)})},this),r},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(10<this.chart._heightPixels()/35?this.chart._heightPixels()/35:10)+"px"},this._getHorizontalPadding=function(){return isNaN(this.horizontalPadding)?20:this.horizontalPadding},this._getVerticalPadding=function(){return isNaN(this.verticalPadding)?2:this.verticalPadding},this._heightPixels=function(){return H._parseYPosition(this.height,this.chart.svg.node())},this._widthPixels=function(){return H._parseXPosition(this.width,this.chart.svg.node())},this._xPixels=function(){return H._parseXPosition(this.x,this.chart.svg.node())},this._yPixels=function(){return H._parseYPosition(this.y,this.chart.svg.node())}},series:function(t,e,i,s,a,r,n,o,l,h){this.chart=t,this.x=i,this.y=s,this.z=a,this.c=r,this.p=n,this.plot=o,this.categoryFields=e,this.aggregate=l,this.stacked=h,this.barGap=.2,this.clusterBarGap=.1,this.lineWeight=2,this.lineMarkers=!1,this.afterDraw=null,this.interpolation=W.curveLinear,this.tooltipFontSize="10px",this.tooltipFontFamily="sans-serif",this.radius="auto",this._group=t._group.append("g"),this._group.attr("class","dimple-series-group-"+t.series.length),this._eventHandlers=[],this._positionData=[],this._orderRules=[],this._axisBounds=function(t){var s,a,r,e={min:0,max:0},i=null,n=null,o=[],l=0,h=this._positionData;return"x"===t?(i=this.x,n=this.y):"y"===t?(i=this.y,n=this.x):"z"===t?i=this.z:"p"===t?i=this.p:"c"===t&&(i=this.c),i.showPercent?h.forEach(function(t){t[i.position+"Bound"]<e.min&&(e.min=t[i.position+"Bound"]),t[i.position+"Bound"]>e.max&&(e.max=t[i.position+"Bound"])},this):null===n||null===n.categoryFields||0===n.categoryFields.length?h.forEach(function(t){!this._isStacked()||"x"!==i.position&&"y"!==i.position?(t[i.position+"Value"]<e.min&&(e.min=t[i.position+"Value"]),t[i.position+"Value"]>e.max&&(e.max=t[i.position+"Value"])):t[i.position+"Value"]<0?e.min=e.min+t[i.position+"Value"]:e.max=e.max+t[i.position+"Value"]},this):(s=i.position+"Value",a=n.position+"Field",r=[],h.forEach(function(t){var e=t[a].join("/"),i=r.indexOf(e);-1===i&&(r.push(e),i=r.length-1),void 0===o[i]&&(o[i]={min:0,max:0},l<=i&&(l=i+1)),this.stacked?t[s]<0?o[i].min=o[i].min+t[s]:o[i].max=o[i].max+t[s]:(t[s]<o[i].min&&(o[i].min=t[s]),t[s]>o[i].max&&(o[i].max=t[s]))},this),o.forEach(function(t){void 0!==t&&(t.min<e.min&&(e.min=t.min),t.max>e.max&&(e.max=t.max))},this)),e},this._deepMatch=function(t){var e=!1;return this[t.position]===t?e=!0:void 0!==t._slaves&&null!==t._slaves&&0<t._slaves.length&&t._slaves.forEach(function(t){e=e||this._deepMatch(t)},this),e},this._dropLineOrigin=function(){var e=0,i=0,s={x:null,y:null},a={x:null,y:null};return this.chart.axes.forEach(function(t){"x"===t.position&&null===a.x?t._hasTimeField()?a.x=this.chart._xPixels():a.x=t._origin:"y"===t.position&&null===a.y&&(t._hasTimeField()?a.y=this.chart._yPixels()+this.chart._heightPixels():a.y=t._origin)},this),this.chart.axes.forEach(function(t){"x"!==t.position||this.x.hidden?"y"!==t.position||this.y.hidden||(this._deepMatch(t)&&(0===i?s.x=a.x:1===i&&(s.x=this.chart._xPixels()+this.chart._widthPixels())),i+=1):(this._deepMatch(t)&&(0===e?s.y=a.y:1===e&&(s.y=this.chart._yPixels())),e+=1)},this),s},this._getTooltipFontSize=function(){return this.tooltipFontSize&&"auto"!==this.tooltipFontSize.toString().toLowerCase()?isNaN(this.tooltipFontSize)?this.tooltipFontSize:this.tooltipFontSize+"px":(10<this.chart._heightPixels()/35?this.chart._heightPixels()/35:10)+"px"},this._isStacked=function(){return this.stacked&&(this.x._hasCategories()||this.y._hasCategories())},this.addEventHandler=function(t,e){this._eventHandlers.push({event:t,handler:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getTooltipText=function(i){var s=[];return null!==this.categoryFields&&void 0!==this.categoryFields&&0<this.categoryFields.length&&this.categoryFields.forEach(function(t,e){null!=t&&null!==i.aggField[e]&&void 0!==i.aggField[e]&&s.push(t+(i.aggField[e]!==t?": "+i.aggField[e]:""))},this),this.p?(this.x&&this.x._hasCategories()&&this.x._getTooltipText(s,i),this.y&&this.y._hasCategories()&&this.y._getTooltipText(s,i),this.z&&this.z._hasCategories()&&this.z._getTooltipText(s,i),this.p._getTooltipText(s,i)):(this.x&&this.x._getTooltipText(s,i),this.y&&this.y._getTooltipText(s,i),this.z&&this.z._getTooltipText(s,i)),this.c&&this.c._getTooltipText(s,i),s.filter(function(t,e){return s.indexOf(t)===e})}},storyboard:function(s,t){null!=t&&(t=[].concat(t)),this.chart=s,this.categoryFields=t,this.autoplay=!0,this.frameDuration=3e3,this.storyLabel=null,this.onTick=null,this.fontSize="10px",this.fontFamily="sans-serif",this._frame=0,this._animationTimer=null,this._categories=[],this._cachedCategoryFields=[],this._orderRules=[],this._drawText=function(){var e=this,i=0;e.storyLabel||(e.chart.axes.forEach(function(t){"x"===t.position&&(i+=1)},e),e.storyLabel=e.chart._group.append("text").attr("class","dimple-storyboard-label").attr("opacity",1).attr("x",e.chart._xPixels()+.01*e.chart._widthPixels()).attr("y",e.chart._yPixels()+(10<e.chart._heightPixels()/35?e.chart._heightPixels()/35:10)*(1<i?1.25:-1)).call(function(t){s.noFormats||t.style("font-family",e.fontFamily).style("font-size",e._getFontSize())})),e.storyLabel.text(e.categoryFields.join("\\")+": "+e.getFrameValue())},this._getCategories=function(){return this._categoryFields!==this._cachedCategoryFields&&(this._categories=[],this.chart._getAllData().forEach(function(i){var s="";null!==this.categoryFields&&(this.categoryFields.forEach(function(t,e){0<e&&(s+="/"),s+=i[t]},this),-1===this._categories.indexOf(s)&&(this._categories.push(s),this._categories.length))},this),this._cachedCategoryFields=this._categoryFields),this._categories},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(10<this.chart._heightPixels()/35?this.chart._heightPixels()/35:10)+"px"},this._goToFrameIndex=function(t){this._frame=t%this._getCategories().length,this.chart.draw(this.frameDuration/2)},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getFrameValue=function(){var t=null;return 0<=this._frame&&this._getCategories().length>this._frame&&(t=this._getCategories()[this._frame]),t},this.goToFrame=function(t){if(0<this._getCategories().length){var e=this._getCategories().indexOf(t);this._goToFrameIndex(e)}},this.pauseAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null)},this.startAnimation=function(){var t;null===this._animationTimer&&(null!==this.onTick&&this.onTick(this.getFrameValue()),this._animationTimer=window.setInterval((t=this,function(){t._goToFrameIndex(t._frame+1),null!==t.onTick&&t.onTick(t.getFrameValue()),t._drawText(t.frameDuration/2)}),this.frameDuration))},this.stopAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null,this._frame=0)}}};return H.aggregateMethod.avg=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),t.count=null===t.count||void 0===t.count?1:parseFloat(t.count),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),e.count=null===e.count||void 0===e.count?1:parseFloat(e.count),(t.value*t.count+e.value*e.count)/(t.count+e.count)},H.aggregateMethod.count=function(t,e){return t.count=null===t.count||void 0===t.count?0:parseFloat(t.count),e.count=null===e.count||void 0===e.count?0:parseFloat(e.count),t.count+e.count},H.aggregateMethod.max=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value>e.value?t.value:e.value},H.aggregateMethod.min=function(t,e){return null===t.value?parseFloat(e.value):parseFloat(t.value)<parseFloat(e.value)?parseFloat(t.value):parseFloat(e.value)},H.aggregateMethod.sum=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value+e.value},H.plot.area={stacked:!0,grouped:!0,supportedAxes:["x","y","c"],draw:function(s,r,i){var t,e,a,n,o,l,h,u,c,d,p,g,_,f,x,y,m,v,F,k,w,C,b,P,B=r._positionData,S=[],M=null,L="dimple-series-"+s.series.indexOf(r),T=r.x._hasCategories()||r.y._hasCategories()?0:1,z=!1,O={},A=[],V=[],D=function(t,e){var a;H._drawMarkers(t,s,r,i,L,z,function(t,e,i,s){W.select(e).style("opacity",1),H._showPointTooltip(t,e,i,s)},(a=t,function(t,e,i,s){W.select(e).style("opacity",s.lineMarkers||a.data.length<2?H._helpers.opacity(t,i,s):0),H._removeTooltip(t,e,i,s)}),e)},G=function(t,e){var i;return r.interpolation===W.curveStep&&r[t]._hasCategories()?(i=H._helpers[t](e,s,r)+("y"===t?H._helpers.height(e,s,r):0),r[t].categoryFields.length<2&&(i+=("y"===t?1:-1)*H._helpers[t+"Gap"](s,r))):i=H._helpers["c"+t](e,s,r),parseFloat(i)},E=function(t,e){return W.line().x(function(t){return r.x._hasCategories()||!e?t.x:r.x[e]}).y(function(t){return r.y._hasCategories()||!e?t.y:r.y[e]}).curve(t)},j=function(t,e){return parseFloat(t)-parseFloat(e)},R=function(t,e){return parseFloat(t.x)-parseFloat(e.x)},N=function(t,e,i){var s,a,r=e[e.length-1],n=9999,o=r;for(s=0;s<t.length;s+=1)t[s].x===r.x&&t[s].y===r.y||i<(a=180-Math.atan2(t[s].x-r.x,t[s].y-r.y)*(180/Math.PI))&&a<n&&(o=t[s],n=a);return e.push(o),n};for(t=r.interpolation===W.curveStep?W.curveStepAfter:r.interpolation,p=H._getSeriesOrder(r.data||s.data,r),r.c&&(r.x._hasCategories()&&r.y._hasMeasure()||r.y._hasCategories()&&r.x._hasMeasure())&&(z=!0),r.x._hasCategories()?(b="x",P="y"):r.y._hasCategories()&&(b="y",P="x"),e=0;e<B.length;e+=1){for(o=[],h=-1,n=T;n<B[e].aggField.length;n+=1)o.push(B[e].aggField[n]);for(l=H._createClass(o),n=0;n<S.length;n+=1)if(S[n].keyString===l){h=n;break}-1===h&&(h=S.length,S.push({key:o,keyString:l,color:"white",data:[],points:[],area:{},entry:{},exit:{},group:b&&B[e][b+"Field"]&&2<=B[e][b+"Field"].length?B[e][b+"Field"][0]:"All"})),S[h].data.push(B[e])}for(p&&S.sort(function(t,e){return H._arrayIndexCompare(p,t.key,e.key)}),e=0;e<S.length;e+=1){for(S[e].data.sort(H._getSeriesSortPredicate(s,r,p)),a=0;a<S[e].data.length;a+=1)S[e].points.push({x:G("x",S[e].data[a]),y:G("y",S[e].data[a])}),b&&(O[S[e].group]||(O[S[e].group]={}),O[S[e].group][S[e].points[S[e].points.length-1][b]]=r[P]._origin);g=S[e].points,r.interpolation===W.curveStep&&1<g.length&&b&&(r.x._hasCategories()?(g.push({x:2*g[g.length-1].x-g[g.length-2].x,y:g[g.length-1].y}),O[S[e].group][g[g.length-1][b]]=r[P]._origin):r.y._hasCategories()&&(g=[{x:g[0].x,y:2*g[0].y-g[1].y}].concat(g),O[S[e].group][g[0][b]]=r[P]._origin,S[e].points=g))}for(x in O)if(O.hasOwnProperty(x)){for(y in A[x]=[],O[x])O[x].hasOwnProperty(y)&&A[x].push(parseFloat(y));A[x].sort(j)}for(e=0;e<S.length;e+=1){if(g=S[e].points,m=S[e].group,_=[],V=[],z&&H._addGradient(S[e].key,"fill-area-gradient-"+S[e].keyString,r.x._hasCategories()?r.x:r.y,B,s,i,"fill"),A[m]&&0<A[m].length)for(n=a=0;a<A[m].length;a+=1)A[m][a]>=g[0][b]&&A[m][a]<=g[g.length-1][b]&&((f={})[b]=A[m][a],f[P]=O[m][A[m][a]],_.push(f),g[n][b]>A[m][a]?V.push(f):(V.push(g[n]),O[S[e].group][A[m][a]]=g[n][P],n+=1));else if(r._orderRules&&0<r._orderRules.length)V=g.concat(g[0]);else for(g=g.sort(R),V.push(g[0]),C=0;C=N(g,V,C),V.length<=g.length&&(V[0].x!==V[V.length-1].x||V[0].y!==V[V.length-1].y););_=_.reverse(),v=E(t,"_previousOrigin")(V),F=E(t===W.curveStepAfter?W.curveStepBefore:t===W.curveStepBefore?W.curveStepAfter:t,"_previousOrigin")(_),w=-1===(k=E(W.curveLinear,"_previousOrigin")(V)).indexOf("L")?void 0:k.indexOf("L"),S[e].entry=v+(F&&0<F.length?"L"+F.substring(1):"")+(k&&0<k.length?"L"+k.substring(1,w):0),v=E(t)(V),F=E(t===W.curveStepAfter?W.curveStepBefore:t===W.curveStepBefore?W.curveStepAfter:t)(_),w=-1===(k=E(W.curveLinear)(V)).indexOf("L")?void 0:k.indexOf("L"),S[e].update=v+(F&&0<F.length?"L"+F.substring(1):"")+(k&&0<k.length?"L"+k.substring(1,w):0),v=E(t,"_origin")(V),F=E(t===W.curveStepAfter?W.curveStepBefore:t===W.curveStepBefore?W.curveStepAfter:t,"_origin")(_),w=-1===(k=E(W.curveLinear,"_origin")(V)).indexOf("L")?void 0:k.indexOf("L"),S[e].exit=v+(F&&0<F.length?"L"+F.substring(1):"")+(k&&0<k.length?"L"+k.substring(1,w):0),S[e].color=s.getColor(0<S[e].key.length?S[e].key[S[e].key.length-1]:"All"),S[e].css=s.getClass(0<S[e].key.length?S[e].key[S[e].key.length-1]:"All")}s._tooltipGroup&&s._tooltipGroup.remove(),u=(M=r.shapes?r.shapes.data(S,function(t){return t.key}):r._group.selectAll("."+L).data(S,function(t){return t.key})).enter().append("path").attr("id",function(t){return H._createClass([t.key])}).attr("class",function(t){return L+" dimple-line "+t.keyString+" "+s.customClassList.areaSeries+" "+t.css}).attr("d",function(t){return t.entry}).call(function(t){s.noFormats||t.attr("opacity",function(t){return z?1:t.color.opacity}).style("fill",function(t){return z?"url(#"+H._createClass(["fill-area-gradient-"+t.keyString])+")":t.color.fill}).style("stroke",function(t){return z?"url(#"+H._createClass(["stroke-area-gradient-"+t.keyString])+")":t.color.stroke}).style("stroke-width",r.lineWeight)}).each(function(t){t.markerData=t.data,D(t,this)}),c=s._handleTransition(M.merge(u),i,s).attr("d",function(t){return t.update}).each(function(t){t.markerData=t.data,D(t,this)}),d=s._handleTransition(M.exit(),i,s).attr("d",function(t){return t.exit}).each(function(t){t.markerData=[],D(t,this)}),H._postDrawHandling(r,c,d,i),r.shapes=r._group.selectAll("."+L)}},H.plot.bar={stacked:!0,grouped:!1,supportedAxes:["x","y","c"],draw:function(i,s,t){var e,a,r,n=s._positionData,o=null,l=["dimple-series-"+i.series.indexOf(s),"dimple-bar"],h=!s._isStacked()&&s.x._hasMeasure(),u=!s._isStacked()&&s.y._hasMeasure(),c="none";s.x._hasCategories()&&s.y._hasCategories()?c="both":s.x._hasCategories()?c="x":s.y._hasCategories()&&(c="y"),i._tooltipGroup&&i._tooltipGroup.remove(),e=(o=s.shapes?s.shapes.data(n,function(t){return t.key}):s._group.selectAll("."+l.join(".")).data(n,function(t){return t.key})).enter().append("rect").attr("id",function(t){return H._createClass([t.key])}).attr("class",function(t){var e=[];return e=(e=(e=e.concat(t.aggField)).concat(t.xField)).concat(t.yField),l.join(" ")+" "+H._createClass(e)+" "+i.customClassList.barSeries+" "+H._helpers.css(t,i)}).attr("x",function(t){var e=s.x._previousOrigin;return"x"===c?e=H._helpers.x(t,i,s):"both"===c&&(e=H._helpers.cx(t,i,s)),e}).attr("y",function(t){var e=s.y._previousOrigin;return"y"===c?e=H._helpers.y(t,i,s):"both"===c&&(e=H._helpers.cy(t,i,s)),e}).attr("width",function(t){return"x"===c?H._helpers.width(t,i,s):0}).attr("height",function(t){return"y"===c?H._helpers.height(t,i,s):0}).on("mouseover",function(t){H._showBarTooltip(t,this,i,s)}).on("mouseleave",function(t){H._removeTooltip(t,this,i,s)}).call(function(t){i.noFormats||t.attr("opacity",function(t){return H._helpers.opacity(t,i,s)}).style("fill",function(t){return H._helpers.fill(t,i,s)}).style("stroke",function(t){return H._helpers.stroke(t,i,s)})}),a=i._handleTransition(o.merge(e),t,i,s).attr("x",function(t){return h?H._helpers.cx(t,i,s)-s.x.floatingBarWidth/2:H._helpers.x(t,i,s)}).attr("y",function(t){return u?H._helpers.cy(t,i,s)-s.y.floatingBarWidth/2:H._helpers.y(t,i,s)}).attr("width",function(t){return h?s.x.floatingBarWidth:H._helpers.width(t,i,s)}).attr("height",function(t){return u?s.y.floatingBarWidth:H._helpers.height(t,i,s)}).call(function(t){i.noFormats||t.attr("fill",function(t){return H._helpers.fill(t,i,s)}).attr("stroke",function(t){return H._helpers.stroke(t,i,s)})}),r=i._handleTransition(o.exit(),t,i,s).attr("x",function(t){var e=s.x._origin;return"x"===c?e=H._helpers.x(t,i,s):"both"===c&&(e=H._helpers.cx(t,i,s)),e}).attr("y",function(t){var e=s.y._origin;return"y"===c?e=H._helpers.y(t,i,s):"both"===c&&(e=H._helpers.cy(t,i,s)),e}).attr("width",function(t){return"x"===c?H._helpers.width(t,i,s):0}).attr("height",function(t){return"y"===c?H._helpers.height(t,i,s):0}),H._postDrawHandling(s,a,r,t),s.shapes=s._group.selectAll("."+l.join("."))}},H.plot.bubble={stacked:!1,grouped:!1,supportedAxes:["x","y","z","c"],draw:function(i,e,t){var s,a,r,n=e._positionData,o=null,l=["dimple-series-"+i.series.indexOf(e),"dimple-bubble"];i._tooltipGroup&&i._tooltipGroup.remove(),s=(o=e.shapes?e.shapes.data(n,function(t){return t.key}):e._group.selectAll("."+l.join(".")).data(n,function(t){return t.key})).enter().append("circle").attr("id",function(t){return H._createClass([t.key])}).attr("class",function(t){var e=[];return e=(e=(e=(e=e.concat(t.aggField)).concat(t.xField)).concat(t.yField)).concat(t.zField),l.join(" ")+" "+H._createClass(e)+" "+i.customClassList.bubbleSeries+" "+H._helpers.css(t,i)}).attr("cx",function(t){return e.x._hasCategories()?H._helpers.cx(t,i,e):e.x._previousOrigin}).attr("cy",function(t){return e.y._hasCategories()?H._helpers.cy(t,i,e):e.y._previousOrigin}).attr("r",0).on("mouseover",function(t){H._showPointTooltip(t,this,i,e)}).on("mouseleave",function(t){H._removeTooltip(t,this,i,e)}).call(function(t){i.noFormats||t.attr("opacity",function(t){return H._helpers.opacity(t,i,e)}).style("fill",function(t){return H._helpers.fill(t,i,e)}).style("stroke",function(t){return H._helpers.stroke(t,i,e)})}),a=i._handleTransition(o.merge(s),t,i,e).attr("cx",function(t){return H._helpers.cx(t,i,e)}).attr("cy",function(t){return H._helpers.cy(t,i,e)}).attr("r",function(t){return H._helpers.r(t,i,e)}).call(function(t){i.noFormats||t.attr("fill",function(t){return H._helpers.fill(t,i,e)}).attr("stroke",function(t){return H._helpers.stroke(t,i,e)})}),r=i._handleTransition(o.exit(),t,i,e).attr("r",0).attr("cx",function(t){return e.x._hasCategories()?H._helpers.cx(t,i,e):e.x._origin}).attr("cy",function(t){return e.y._hasCategories()?H._helpers.cy(t,i,e):e.y._origin}),H._postDrawHandling(e,a,r,t),e.shapes=e._group.selectAll("."+l.join("."))}},H.plot.line={stacked:!1,grouped:!0,supportedAxes:["x","y","c"],draw:function(s,r,i){var t,e,a,n,o,l,h,u,c,d,p,g=r._positionData,_=[],f=null,x="dimple-series-"+s.series.indexOf(r),y=r.x._hasCategories()||r.y._hasCategories()?0:1,m=!1,v=function(t,e){var a;H._drawMarkers(t,s,r,i,x,m,function(t,e,i,s){W.select(e).style("opacity",1),H._showPointTooltip(t,e,i,s)},(a=t,function(t,e,i,s){W.select(e).style("opacity",s.lineMarkers||a.data.length<2?H._helpers.opacity(t,i,s):0),H._removeTooltip(t,e,i,s)}),e)},F=function(t,e){var i;return r.interpolation===W.curveStep&&r[t]._hasCategories()?(r.barGap=0,r.clusterBarGap=0,i=H._helpers[t](e,s,r)+("y"===t?H._helpers.height(e,s,r):0)):i=H._helpers["c"+t](e,s,r),parseFloat(i.toFixed(1))},k=function(t,e){return W.line().x(function(t){return r.x._hasCategories()||!e?t.x:r.x[e]}).y(function(t){return r.y._hasCategories()||!e?t.y:r.y[e]}).curve(t)};for(t=r.interpolation===W.curveStep?W.curveStepAfter:r.interpolation,p=H._getSeriesOrder(r.data||s.data,r),r.c&&(r.x._hasCategories()&&r.y._hasMeasure()||r.y._hasCategories()&&r.x._hasMeasure())&&(m=!0),e=0;e<g.length;e+=1){for(o=[],h=-1,n=y;n<g[e].aggField.length;n+=1)o.push(g[e].aggField[n]);for(l=H._createClass(o),n=0;n<_.length;n+=1)if(_[n].keyString===l){h=n;break}-1===h&&(h=_.length,_.push({key:o,keyString:l,color:"white",data:[],markerData:[],points:[],line:{},entry:{},exit:{}})),_[h].data.push(g[e])}for(p&&_.sort(function(t,e){return H._arrayIndexCompare(p,t.key,e.key)}),e=0;e<_.length;e+=1){for(_[e].data.sort(H._getSeriesSortPredicate(s,r,p)),m&&H._addGradient(_[e].key,"fill-line-gradient-"+_[e].keyString,r.x._hasCategories()?r.x:r.y,g,s,i,"fill"),a=0;a<_[e].data.length;a+=1)_[e].points.push({x:F("x",_[e].data[a]),y:F("y",_[e].data[a])});r.interpolation===W.curveStep&&1<_[e].points.length&&(r.x._hasCategories()?_[e].points.push({x:2*_[e].points[_[e].points.length-1].x-_[e].points[_[e].points.length-2].x,y:_[e].points[_[e].points.length-1].y}):r.y._hasCategories()&&(_[e].points=[{x:_[e].points[0].x,y:2*_[e].points[0].y-_[e].points[1].y}].concat(_[e].points))),_&&_[e]&&_[e].points&&1===_[e].points.length&&_[e].points.push({x:_[e].points[0].x,y:_[e].points[0].y}),_[e].entry=k(t,"_previousOrigin")(_[e].points),_[e].update=k(t)(_[e].points),_[e].exit=k(t,"_origin")(_[e].points),_[e].color=s.getColor(0<_[e].key.length?_[e].key[_[e].key.length-1]:"All"),_[e].css=s.getClass(0<_[e].key.length?_[e].key[_[e].key.length-1]:"All")}s._tooltipGroup&&s._tooltipGroup.remove(),u=(f=r.shapes?r.shapes.data(_,function(t){return t.key}):r._group.selectAll("."+x).data(_,function(t){return t.key})).enter().append("path").attr("id",function(t){return H._createClass([t.key])}).attr("class",function(t){return x+" dimple-line "+t.keyString+" "+s.customClassList.lineSeries+" "+t.css}).attr("d",function(t){return t.entry}).call(function(t){s.noFormats||t.attr("opacity",function(t){return m?1:t.color.opacity}).style("fill","none").style("stroke",function(t){return m?"url(#"+H._createClass(["fill-line-gradient-"+t.keyString])+")":t.color.stroke}).style("stroke-width",r.lineWeight)}).each(function(t){t.markerData=t.data,v(t,this)}),c=s._handleTransition(f.merge(u),i,s).attr("d",function(t){return t.update}).each(function(t){t.markerData=t.data,v(t,this)}),d=s._handleTransition(f.exit(),i,s).attr("d",function(t){return t.exit}).each(function(t){t.markerData=[],v(t,this)}),H._postDrawHandling(r,c,d,i),r.shapes=r._group.selectAll("."+x)}},H.plot.pie={stacked:!1,grouped:!1,supportedAxes:["x","y","c","z","p"],draw:function(a,r,e){var t,i,s,n=r._positionData,o=null,l=["dimple-series-"+a.series.indexOf(r),"dimple-pie"],h=function(t){return r.x&&r.y?H._helpers.r(t,a,r):a._widthPixels()<a._heightPixels()?a._widthPixels()/2:a._heightPixels()/2},u=function(t){var e=h(t);return r.outerRadius&&(e=H._parsePosition(r.outerRadius,e)),Math.max(e,0)},c=function(t){var e=0;return r.innerRadius&&(e=H._parsePosition(r.innerRadius,h(t))),Math.max(e,0)},d=function(t){return W.arc().innerRadius(c(t)).outerRadius(u(t))(t)},p=function(t){t.innerRadius=c(t),t.outerRadius=u(t);var e,i=W.interpolate(this._current,t);return e=W.arc().innerRadius(function(t){return t.innerRadius}).outerRadius(function(t){return t.outerRadius}),this._current=i(0),function(t){return e(i(t))}},g=function(s){return function(t){var e,i;return r.x&&r.y?(e=!s||r.x._hasCategories()?H._helpers.cx(t,a,r):r.x._previousOrigin,i=!s||r.y._hasCategories()?H._helpers.cy(t,a,r):r.y._previousOrigin):(e=a._xPixels()+a._widthPixels()/2,i=a._yPixels()+a._heightPixels()/2),"translate("+e+","+i+")"}};a._tooltipGroup&&a._tooltipGroup.remove(),t=(o=r.shapes?r.shapes.data(n,function(t){return t.key}):r._group.selectAll("."+l.join(".")).data(n,function(t){return t.key})).enter().append("path").attr("id",function(t){return H._createClass([t.key])}).attr("class",function(t){var e=[];return e=(e=e.concat(t.aggField)).concat(t.pField),l.join(" ")+" "+H._createClass(e)+" "+a.customClassList.pieSeries+" "+H._helpers.css(t,a)}).attr("d",d).on("mouseover",function(t){H._showBarTooltip(t,this,a,r)}).on("mouseleave",function(t){H._removeTooltip(t,this,a,r)}).call(function(t){a.noFormats||t.attr("opacity",function(t){return H._helpers.opacity(t,a,r)}).style("fill",function(t){return H._helpers.fill(t,a,r)}).style("stroke",function(t){return H._helpers.stroke(t,a,r)})}).attr("transform",g(!0)).each(function(t){(this._current=t).innerRadius=c(t),t.outerRadius=u(t)}),i=a._handleTransition(o.merge(t),e,a,r).call(function(t){e&&0<e?t.attrTween("d",p):t.attr("d",d),a.noFormats||t.attr("fill",function(t){return H._helpers.fill(t,a,r)}).attr("stroke",function(t){return H._helpers.stroke(t,a,r)})}).attr("transform",g(!1)),s=a._handleTransition(o.exit(),e,a,r).attr("transform",g(!0)).attr("d",d),H._postDrawHandling(r,i,s,e),r.shapes=r._group.selectAll("."+l.join("."))}},H._addGradient=function(t,e,i,a,s,r,n){var o=[].concat(t),l=s.svg.select("#"+H._createClass([e])),h=[],u=i.position+"Field",c=!0,d=[];a.forEach(function(t){-1===h.indexOf(t[u])&&t.aggField.join("_")===o.join("_")&&h.push(t[u])},this),h=h.sort(function(t,e){return i._scale(t)-i._scale(e)}),null===l.node()&&(c=!1,l=s.svg.append("defs").append("linearGradient").attr("id",H._createClass([e])).attr("gradientUnits","userSpaceOnUse").attr("x1","x"===i.position?i._scale(h[0])+s._widthPixels()/h.length/2:0).attr("y1","y"===i.position?i._scale(h[0])-s._heightPixels()/h.length/2:0).attr("x2","x"===i.position?i._scale(h[h.length-1])+s._widthPixels()/h.length/2:0).attr("y2","y"===i.position?i._scale(h[h.length-1])-s._heightPixels()/h.length/2:0)),h.forEach(function(t,e){var i={},s=0;for(s=0;s<a.length;s+=1)if(a[s].aggField.join("_")===o.join("_")&&a[s][u].join("_")===t.join("_")){i=a[s];break}d.push({offset:Math.round(e/(h.length-1)*100)+"%",color:i[n]})},this),c?s._handleTransition(l.selectAll("stop").data(d),r,s).attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}):l.selectAll("stop").data(d).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color})},H._arrayIndexCompare=function(t,e,i){var s,a,r,n,o,l;for(a=0;a<t.length;a+=1){for(o=n=!0,l=[].concat(t[a]),r=0;r<e.length;r+=1)n=n&&e[r]===l[r];for(r=0;r<i.length;r+=1)o=o&&i[r]===l[r];if(n||o){s=n&&o?0:n?-1:1;break}}return s},H._createClass=function(t){var e,i,s=[];if(i=function(t){var e=t.charCodeAt(0),i="-";return 65<=e&&e<=90&&(i=t.toLowerCase()),i},0<t.length)for(e=0;e<t.length;e+=1)t[e]&&s.push("dimple-"+t[e].toString().replace(/[^a-z0-9]/g,i));else s=["dimple-all"];return s.join(" ")},H._drawMarkerBacks=function(t,e,i,s,a,r){var n,o,l,h=["dimple-marker-back",a,t.keyString];i.lineMarkers&&(n=null===i._markerBacks||void 0===i._markerBacks||void 0===i._markerBacks[t.keyString]?i._group.selectAll("."+h.join(".")).data(t.markerData):i._markerBacks[t.keyString].data(t.markerData,function(t){return t.key}),(l=r.nextSibling&&r.nextSibling.id?n.enter().insert("circle","#"+r.nextSibling.id):n.enter().append("circle")).attr("id",function(t){return H._createClass([t.key+" Marker Back"])}).attr("class",function(t){var e=[];return i.x._hasCategories()&&(e=e.concat(t.xField)),i.y._hasCategories()&&(e=e.concat(t.yField)),H._createClass(e)+" "+h.join(" ")}).attr("cx",function(t){return i.x._hasCategories()?H._helpers.cx(t,e,i):i.x._previousOrigin}).attr("cy",function(t){return i.y._hasCategories()?H._helpers.cy(t,e,i):i.y._previousOrigin}).attr("r",0).attr("fill","white").attr("stroke","none"),e._handleTransition(n.merge(l),s,e).attr("cx",function(t){return H._helpers.cx(t,e,i)}).attr("cy",function(t){return H._helpers.cy(t,e,i)}).attr("r",2+i.lineWeight),o=e._handleTransition(n.exit(),s,e).attr("cx",function(t){return i.x._hasCategories()?H._helpers.cx(t,e,i):i.x._origin}).attr("cy",function(t){return i.y._hasCategories()?H._helpers.cy(t,e,i):i.y._origin}).attr("r",0),0===s?o.remove():o.each("end",function(){W.select(this).remove()}),void 0!==i._markerBacks&&null!==i._markerBacks||(i._markerBacks={}),i._markerBacks[t.keyString]=n)},H._drawMarkers=function(e,s,a,t,i,r,n,o,l){var h,u,c,d=["dimple-marker",i,e.keyString];h=null===a._markers||void 0===a._markers||void 0===a._markers[e.keyString]?a._group.selectAll("."+d.join(".")).data(e.markerData):a._markers[e.keyString].data(e.markerData,function(t){return t.key}),(c=l.nextSibling&&l.nextSibling.id?h.enter().insert("circle","#"+l.nextSibling.id):h.enter().append("circle")).attr("id",function(t){return H._createClass([t.key+" Marker"])}).attr("class",function(t){var e=[],i=s.getClass(0<t.aggField.length?t.aggField[t.aggField.length-1]:"All");return a.x._hasCategories()&&(e=e.concat(t.xField)),a.y._hasCategories()&&(e=e.concat(t.yField)),H._createClass(e)+" "+d.join(" ")+" "+s.customClassList.lineMarker+" "+i}).on("mouseover",function(t){n(t,this,s,a)}).on("mouseleave",function(t){o(t,this,s,a)}).attr("cx",function(t){return a.x._hasCategories()?H._helpers.cx(t,s,a):a.x._previousOrigin}).attr("cy",function(t){return a.y._hasCategories()?H._helpers.cy(t,s,a):a.y._previousOrigin}).attr("r",0).attr("opacity",a.lineMarkers||e.data.length<2?e.color.opacity:0).call(function(t){s.noFormats||t.attr("fill","white").style("stroke-width",a.lineWeight).attr("stroke",function(t){return r?H._helpers.fill(t,s,a):e.color.stroke})}),s._handleTransition(h.merge(c),t,s).attr("cx",function(t){return H._helpers.cx(t,s,a)}).attr("cy",function(t){return H._helpers.cy(t,s,a)}).attr("r",2+a.lineWeight).attr("opacity",a.lineMarkers||e.data.length<2?e.color.opacity:0).call(function(t){s.noFormats||t.attr("fill","white").style("stroke-width",a.lineWeight).attr("stroke",function(t){return r?H._helpers.fill(t,s,a):e.color.stroke})}),u=s._handleTransition(h.exit(),t,s).attr("cx",function(t){return a.x._hasCategories()?H._helpers.cx(t,s,a):a.x._origin}).attr("cy",function(t){return a.y._hasCategories()?H._helpers.cy(t,s,a):a.y._origin}).attr("r",0),0===t?u.remove():u.each("end",function(){W.select(this).remove()}),void 0!==a._markers&&null!==a._markers||(a._markers={}),a._markers[e.keyString]=h,H._drawMarkerBacks(e,s,a,t,i,l)},H._ease=function(t,e){if(t&&e&&"[object String]"===Object.prototype.toString.call(e)){switch(e){case"linear":e=W.easeLinear;break;case"poly":e=W.easePoly;break;case"quad":e=W.easeQuad;break;case"cubic":e=W.easeCubic;break;case"sin":e=W.easeSin;break;case"exp":e=W.easeExp;break;case"circle":e=W.easeCircle;break;case"elastic":e=W.easeElastic;break;case"back":e=W.easeBack;break;case"bounce":e=W.easeBounce}t.ease(e)}},H._getOrderedList=function(a,t,e){var i,r=[],s=[],l=[].concat(t),n=[].concat(t),o=[];return null!=e&&(o=o.concat(e)),(o=o.concat({ordering:l,desc:!1})).forEach(function(t){var e,i=[],s=[];if("function"==typeof t.ordering){if(a&&0<a.length)for(e in a[0])a[0].hasOwnProperty(e)&&-1===n.indexOf(e)&&n.push(e)}else if(t.ordering instanceof Array){for(e=0;e<t.ordering.length;e+=1)a&&0<a.length&&a[0].hasOwnProperty(t.ordering[e])&&s.push(t.ordering[e]),i.push(t.ordering[e]);s.length>i.length/2?n.concat(s):t.values=i}else n.push(t.ordering)},this),i=H._rollUp(a,l,n),1<=o.length&&(o.forEach(function(t){var h=null!==t.desc&&void 0!==t.desc&&t.desc,i=t.ordering,o=[],u=function(t){var e,i=0;for(e=0;e<t.length;e+=1){if(isNaN(t[e])){i=void 0;break}i+=parseFloat(t[e])}return i};"function"==typeof i?r.push(function(t,e){return(h?-1:1)*i(t,e)}):t.values&&0<t.values.length?(t.values.forEach(function(t){o.push([].concat(t).join("|"))},this),r.push(function(t,e){var i,s,a,r="",n="";for(a=0;a<l.length;a+=1)0<a&&(r+="|",n+="|"),r+=t[l[a]],n+=e[l[a]];return i=o.indexOf(r),s=o.indexOf(n),i=i<0?h?-1:o.length:i,s=s<0?h?-1:o.length:s,(h?-1:1)*(i-s)})):[].concat(t.ordering).forEach(function(l){r.push(function(t,e){var i,s,a,r,n,o=0;return void 0!==t[l]&&void 0!==e[l]&&(i=[].concat(t[l]),s=[].concat(e[l]),a=0,r=u(i),n=u(s),isNaN(r)||isNaN(n)?isNaN(Date.parse(i[0]))||isNaN(Date.parse(s[0]))?i[0]<s[0]?a=-1:i[0]>s[0]&&(a=1):a=Date.parse(i[0])-Date.parse(s[0]):a=parseFloat(r)-parseFloat(n),o=a),(h?-1:1)*o})})}),i.sort(function(t,e){for(var i=0,s=0;i<r.length&&0===s;)s=r[i](t,e),i+=1;return s}),i.forEach(function(t){var e,i=[];if(1===l.length)s.push(t[l[0]]);else{for(e=0;e<l.length;e+=1)i.push(t[l[e]]);s.push(i)}},this)),s},H._getSeriesOrder=function(t,e){var i=[].concat(e._orderRules),s=e.categoryFields,a=[];return null!=s&&0<s.length&&(null!==e.c&&void 0!==e.c&&e.c._hasMeasure()&&i.push({ordering:e.c.measure,desc:!0}),e.x._hasMeasure()&&i.push({ordering:e.x.measure,desc:!0}),e.y._hasMeasure()&&i.push({ordering:e.y.measure,desc:!0}),a=H._getOrderedList(t,s,i)),a},H._getSeriesSortPredicate=function(s,a,r){return function(t,e){var i=0;return a.x._hasCategories()&&(i=H._helpers.cx(t,s,a)-H._helpers.cx(e,s,a)),0===i&&a.y._hasCategories()&&(i=H._helpers.cy(t,s,a)-H._helpers.cy(e,s,a)),0===i&&r&&(i=H._arrayIndexCompare(r,t.aggField,e.aggField)),i}},H._helpers={cx:function(t,e,i){return null!==i.x.measure&&void 0!==i.x.measure?i.x._scale(t.cx):i.x._hasCategories()&&2<=i.x.categoryFields.length?i.x._scale(t.cx)+H._helpers.xGap(e,i)+(t.xOffset+.5)*((e._widthPixels()/i.x._max-2*H._helpers.xGap(e,i))*t.width):i.x._scale(t.cx)+e._widthPixels()/i.x._max/2},cy:function(t,e,i){return null!==i.y.measure&&void 0!==i.y.measure?i.y._scale(t.cy):null!==i.y.categoryFields&&void 0!==i.y.categoryFields&&2<=i.y.categoryFields.length?i.y._scale(t.cy)-e._heightPixels()/i.y._max+H._helpers.yGap(e,i)+(t.yOffset+.5)*((e._heightPixels()/i.y._max-2*H._helpers.yGap(e,i))*t.height):i.y._scale(t.cy)-e._heightPixels()/i.y._max/2},r:function(t,e,i){var s=0,a=1;return null===i.z||void 0===i.z?s=i.radius&&"auto"!==i.radius?i.radius:5:(i.radius&&"auto"!==i.radius&&1<i.radius&&(a=i.radius/i.z._scale(i.z._max)),s=i.z._hasMeasure()?i.z._scale(t.r)*a:i.z._scale(e._heightPixels()/100)*a),s},xGap:function(t,e){var i=0;return(null===e.x.measure||void 0===e.x.measure)&&0<e.barGap&&(i=t._widthPixels()/e.x._max*(.99<e.barGap?.99:e.barGap)/2),i},xClusterGap:function(t,e,i){var s=0;return null!==i.x.categoryFields&&void 0!==i.x.categoryFields&&2<=i.x.categoryFields.length&&0<i.clusterBarGap&&!i.x._hasMeasure()&&(s=t.width*(e._widthPixels()/i.x._max-2*H._helpers.xGap(e,i))*(.99<i.clusterBarGap?.99:i.clusterBarGap)/2),s},yGap:function(t,e){var i=0;return(null===e.y.measure||void 0===e.y.measure)&&0<e.barGap&&(i=t._heightPixels()/e.y._max*(.99<e.barGap?.99:e.barGap)/2),i},yClusterGap:function(t,e,i){var s=0;return null!==i.y.categoryFields&&void 0!==i.y.categoryFields&&2<=i.y.categoryFields.length&&0<i.clusterBarGap&&!i.y._hasMeasure()&&(s=t.height*(e._heightPixels()/i.y._max-2*H._helpers.yGap(e,i))*(.99<i.clusterBarGap?.99:i.clusterBarGap)/2),s},x:function(t,e,i){return i.x._hasTimeField()?i.x._scale(t.x)-H._helpers.width(t,e,i)/2:null!==i.x.measure&&void 0!==i.x.measure?i.x._scale(t.x):i.x._scale(t.x)+H._helpers.xGap(e,i)+t.xOffset*(H._helpers.width(t,e,i)+2*H._helpers.xClusterGap(t,e,i))+H._helpers.xClusterGap(t,e,i)},y:function(t,e,i){return i.y._hasTimeField()?i.y._scale(t.y)-H._helpers.height(t,e,i)/2:null!==i.y.measure&&void 0!==i.y.measure?i.y._scale(t.y):i.y._scale(t.y)-e._heightPixels()/i.y._max+H._helpers.yGap(e,i)+t.yOffset*(H._helpers.height(t,e,i)+2*H._helpers.yClusterGap(t,e,i))+H._helpers.yClusterGap(t,e,i)},width:function(t,e,i){return null!==i.x.measure&&void 0!==i.x.measure?Math.abs(i.x._scale(t.x<0?t.x-t.width:t.x+t.width)-i.x._scale(t.x)):i.x._hasTimeField()?i.x.floatingBarWidth:t.width*(e._widthPixels()/i.x._max-2*H._helpers.xGap(e,i))-2*H._helpers.xClusterGap(t,e,i)},height:function(t,e,i){return i.y._hasTimeField()?i.y.floatingBarWidth:null!==i.y.measure&&void 0!==i.y.measure?Math.abs(i.y._scale(t.y)-i.y._scale(t.y<=0?t.y+t.height:t.y-t.height)):t.height*(e._heightPixels()/i.y._max-2*H._helpers.yGap(e,i))-2*H._helpers.yClusterGap(t,e,i)},opacity:function(t,e,i){return null!==i.c&&void 0!==i.c?t.opacity:e.getColor(t.aggField.slice(-1)[0]).opacity},fill:function(t,e,i){return null!==i.c&&void 0!==i.c?t.fill:e.getColor(t.aggField.slice(-1)[0]).fill},stroke:function(t,e,i){return null!==i.c&&void 0!==i.c?t.stroke:e.getColor(t.aggField.slice(-1)[0]).stroke},css:function(t,e){return e.getClass(t.aggField.slice(-1)[0])}},H._parentHeight=function(t){var e=t.getBoundingClientRect().height;return(!e||e<0)&&(e=t.clientHeight),e},H._parentWidth=function(t){var e=t.getBoundingClientRect().width;return(!e||e<0)&&(e=t.clientWidth),e},H._parsePosition=function(e,i){var s=0;return e&&e.toString().split(",").forEach(function(t){t&&(isNaN(t)?"%"===t.slice(-1)?s+=i*(parseFloat(t.slice(0,t.length-1))/100):"px"===t.slice(-2)?s+=parseFloat(t.slice(0,t.length-2)):s=e:s+=parseFloat(t))},this),s<0&&(s=i+s),s},H._parseXPosition=function(t,e){return H._parsePosition(t,H._parentWidth(e))},H._parseYPosition=function(t,e){return H._parsePosition(t,H._parentHeight(e))},H._postDrawHandling=function(i,t,e,s){0===s?(t.each(function(t,e){i.afterDraw&&i.afterDraw(this,t,e)}),e.remove()):(t.on("end",function(t,e){i.afterDraw&&i.afterDraw(this,t,e)}),e.call(function(){i.shapes&&i.shapes.exit().remove()}))},H._removeTooltip=function(t,e,i,s){i._tooltipGroup&&i._tooltipGroup.remove()},H._rollUp=function(t,r,n){var o=[];return r=null!=r?[].concat(r):[],t.forEach(function(i){var s=-1,e={},a=!0;o.forEach(function(e,t){-1===s&&(a=!0,r.forEach(function(t){a=a&&i[t]===e[t]},this),a&&(s=t))},this),-1!==s?e=o[s]:(r.forEach(function(t){e[t]=i[t]},this),o.push(e),s=o.length-1),n.forEach(function(t){-1===r.indexOf(t)&&(void 0===e[t]&&(e[t]=[]),e[t]=e[t].concat(i[t]))},this),o[s]=e},this),o},H._showBarTooltip=function(t,e,a,i){var s,r,n,o,l,h,u=W.select(e),c=u.node().getBBox().x,d=u.node().getBBox().y,p=u.node().getBBox().width,g=u.node().getBBox().height,_=u.attr("opacity"),f=u.attr("fill"),x=i._dropLineOrigin(),y=W.rgb(W.rgb(f).r+.6*(255-W.rgb(f).r),W.rgb(f).g+.6*(255-W.rgb(f).g),W.rgb(f).b+.6*(255-W.rgb(f).b)),m=W.rgb(W.rgb(f).r+.8*(255-W.rgb(f).r),W.rgb(f).g+.8*(255-W.rgb(f).g),W.rgb(f).b+.8*(255-W.rgb(f).b)),v=i.getTooltipText(t),F=0,k=0,w=0,C=function(t,e){var i=u.node().getCTM(),s=a.svg.node().createSVGPoint();return s.x=t||0,s.y=e||0,s.matrixTransform(i)};null!==a._tooltipGroup&&void 0!==a._tooltipGroup&&a._tooltipGroup.remove(),a._tooltipGroup=a.svg.append("g"),i.p||(h=i._isStacked()?1:p/2,i.x._hasCategories()||null===x.y||a._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+a.customClassList.tooltipDropLine).attr("x1",c<i.x._origin?c+h:c+p-h).attr("y1",d<x.y?d+g:d).attr("x2",c<i.x._origin?c+h:c+p-h).attr("y2",d<x.y?d+g:d).call(function(){a.noFormats||this.style("fill","none").style("stroke",f).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",_)}).transition().delay(375).duration(375).ease(W.easeLinear).attr("y2",d<x.y?x.y-1:x.y+1),h=i._isStacked()?1:g/2,i.y._hasCategories()||null===x.x||a._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+a.customClassList.tooltipDropLine).attr("x1",c<x.x?c+p:c).attr("y1",d<i.y._origin?d+h:d+g-h).attr("x2",c<x.x?c+p:c).attr("y2",d<i.y._origin?d+h:d+g-h).call(function(t){a.noFormats||t.style("fill","none").style("stroke",f).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",_)}).transition().delay(375).duration(375).ease(W.easeLinear).attr("x2",c<x.x?x.x-1:x.x+1)),r=(s=a._tooltipGroup.append("g")).append("rect").attr("class","dimple-tooltip "+a.customClassList.tooltipBox),s.selectAll(".dimple-dont-select-any").data(v).enter().append("text").attr("class","dimple-tooltip "+a.customClassList.tooltipLabel).text(function(t){return t}).call(function(t){a.noFormats||t.style("font-family",i.tooltipFontFamily).style("font-size",i._getTooltipFontSize())}),s.each(function(){k=this.getBBox().width>k?this.getBBox().width:k,w=this.getBBox().width>w?this.getBBox().height:w}),s.selectAll("text").attr("x",0).attr("y",function(){return(F+=this.getBBox().height)-this.getBBox().height/2}),r.attr("x",-5).attr("y",-5).attr("height",Math.floor(F+5)-.5).attr("width",k+10).attr("rx",5).attr("ry",5).call(function(t){a.noFormats||t.style("fill",m).style("stroke",y).style("stroke-width",2).style("opacity",.95)}),C(c+p+5+10+k).x<parseFloat(a.svg.node().getBBox().width)?(n=c+p+5+10,o=d+g/2-(F-(w-5))/2):0<C(c-(15+k)).x?(n=c-(15+k),o=d+g/2-(F-(w-5))/2):C(0,d+g+F+10+5).y<parseFloat(a.svg.node().getBBox().height)?(n=(n=0<(n=c+p/2-(10+k)/2)?n:10)+k<parseFloat(a.svg.node().getBBox().width)?n:parseFloat(a.svg.node().getBBox().width)-k-10,o=d+g+10):(n=(n=0<(n=c+p/2-(10+k)/2)?n:10)+k<parseFloat(a.svg.node().getBBox().width)?n:parseFloat(a.svg.node().getBBox().width)-k-10,o=d-F-(w-5)),l=C(n,o),s.attr("transform","translate("+l.x+" , "+l.y+")")},H._showPointTooltip=function(t,e,i,s){var a,r,n,o,l=W.select(e),h=parseFloat(l.attr("cx")),u=parseFloat(l.attr("cy")),c=parseFloat(l.attr("r")),d=H._helpers.opacity(t,i,s),p=l.attr("stroke"),g=s._dropLineOrigin(),_=W.rgb(W.rgb(p).r+.6*(255-W.rgb(p).r),W.rgb(p).g+.6*(255-W.rgb(p).g),W.rgb(p).b+.6*(255-W.rgb(p).b)),f=W.rgb(W.rgb(p).r+.8*(255-W.rgb(p).r),W.rgb(p).g+.8*(255-W.rgb(p).g),W.rgb(p).b+.8*(255-W.rgb(p).b)),x=0,y=0,m=0,v=s.getTooltipText(t);null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),i._tooltipGroup=i.svg.append("g"),i._tooltipGroup.append("circle").attr("class","dimple-line-marker-circle "+i.customClassList.lineMarkerCircle).attr("cx",h).attr("cy",u).attr("r",c).call(function(t){i.noFormats||t.attr("opacity",0).style("fill","none").style("stroke",p).style("stroke-width",1)}).transition().duration(375).ease(W.easeLinear).attr("r",c+s.lineWeight+2).call(function(t){i.noFormats||t.attr("opacity",1).style("stroke-width",2)}),null!==g.y&&i._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+i.customClassList.tooltipDropLine).attr("x1",h).attr("y1",u<g.y?u+c+s.lineWeight+2:u-c-s.lineWeight-2).attr("x2",h).attr("y2",u<g.y?u+c+s.lineWeight+2:u-c-s.lineWeight-2).call(function(t){i.noFormats||t.style("fill","none").style("stroke",p).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",d)}).transition().delay(375).duration(375).ease(W.easeLinear).attr("y2",u<g.y?g.y-1:g.y+1),null!==g.x&&i._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+i.customClassList.tooltipDropLine).attr("x1",h<g.x?h+c+s.lineWeight+2:h-c-s.lineWeight-2).attr("y1",u).attr("x2",h<g.x?h+c+s.lineWeight+2:h-c-s.lineWeight-2).attr("y2",u).call(function(t){i.noFormats||t.style("fill","none").style("stroke",p).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",d)}).transition().delay(375).duration(375).ease(W.easeLinear).attr("x2",h<g.x?g.x-1:g.x+1),r=(a=i._tooltipGroup.append("g")).append("rect").attr("class","dimple-tooltip "+i.customClassList.tooltipBox),a.selectAll(".dont-select-any").data(v).enter().append("text").attr("class","dimple-tooltip "+i.customClassList.tooltipLabel).text(function(t){return t}).call(function(t){i.noFormats||t.style("font-family",s.tooltipFontFamily).style("font-size",s._getTooltipFontSize())}),a.each(function(){y=this.getBBox().width>y?this.getBBox().width:y,m=this.getBBox().width>m?this.getBBox().height:m}),a.selectAll("text").attr("x",0).attr("y",function(){return(x+=this.getBBox().height)-this.getBBox().height/2}),r.attr("x",-5).attr("y",-5).attr("height",Math.floor(x+5)-.5).attr("width",y+10).attr("rx",5).attr("ry",5).call(function(t){i.noFormats||t.style("fill",f).style("stroke",_).style("stroke-width",2).style("opacity",.95)}),h+c+5+10+y<parseFloat(i.svg.node().getBBox().width)?(n=h+c+5+10,o=u-(x-(m-5))/2):0<h-c-(15+y)?(n=h-c-(15+y),o=u-(x-(m-5))/2):u+c+x+10+5<parseFloat(i.svg.node().getBBox().height)?(n=(n=0<(n=h-(10+y)/2)?n:10)+y<parseFloat(i.svg.node().getBBox().width)?n:parseFloat(i.svg.node().getBBox().width)-y-10,o=u+c+10):(n=(n=0<(n=h-(10+y)/2)?n:10)+y<parseFloat(i.svg.node().getBBox().width)?n:parseFloat(i.svg.node().getBBox().width)-y-10,o=u-x-(m-5)),a.attr("transform","translate("+n+" , "+o+")")},H.filterData=function(t,e,i){var s=t;return null!==e&&null!==i&&(null!=i&&(i=[].concat(i)),s=[],t.forEach(function(t){null===t[e]?s.push(t):-1<i.indexOf([].concat(t[e]).join("/"))&&s.push(t)},this)),s},H.getUniqueValues=function(t,e){var a=[];return null!=e&&(e=[].concat(e),t.forEach(function(i){var s="";e.forEach(function(t,e){0<e&&(s+="/"),s+=i[t]},this),-1===a.indexOf(s)&&a.push(s)},this)),a},H.newSvg=function(t,e,i){var s=null;if(null==t&&(t="body"),(s=W.select(t)).empty())throw"The '"+t+"' selector did not match any elements.  Please prefix with '#' to select by id or '.' to select by class";return s.append("svg").attr("width",e).attr("height",i)},H});